{% extends 'base.html' %}
{% load static %}
{% block title %} Ezberle {% endblock %}

{% block content %}
<div class="container container-home">

<div class="row">

    <div class="col-lg-3 col-sm-6 text-center">
        <div class="card card-shadow">
            <div><a href="https://www.merriam-webster.com/" target="_blank"><img class="card-img-top mx-auto" src="{% static 'img/merriam.png' %}" alt="Merriam Webster"></a></div>
            <div class="card-body home-card">
                <a href="{% url 'dictionary' word_mer.english %}" target="_blank">
                    <h4 id="word_1" class="font-weight-bold">{{ word_mer.english }}</h4>
                </a>
                {% if word_mer.turkish.all %}
                    <ul class="wotd-tr-list">
                    {% for tr in word_mer.turkish.all %}
                        <li>
                            {{ tr }}
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <ul class="wotd-tr-list no-tr" >
                        (...)
                    </ul>
                {% endif %}
                <div class="home-card-footer">
                {% if word_mer.audio is not None %}
                    <div>
                        <span class="audio">
                            <i title="Dinle" data-id="1" class="material-icons">volume_up</i>
                        </span>
                    </div>
                    <audio id="au-1" src="{{word_mer.audio}}"></audio>
                {% else %}
                    <div>
                        <span class="audio"><i title="Ses mevcut değil" class="material-icons">volume_off</i>
                        </span>
                    </div>
                    <audio src=""></audio>
                {% endif %}
                {% if word_mer.turkish.all %}
                    {% if user.is_authenticated %}
                        {% if mer_exists %}
                            <div><button data-id="1" class="btn add-btn-home btn-after"><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="1" class="btn add-btn-home btn-before"><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before" data-toggle="modal" data-target="#loginModal"><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% else %}
                        {% if user.is_authenticated %}
                        {% if mer_exists %}
                            <div><button data-id="1" class="btn add-btn-home btn-after disabled not-allowed" disabled><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="1" class="btn add-btn-home btn-before disabled not-allowed" disabled><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before disabled not-allowed" data-toggle="modal" data-target="#loginModal" disabled><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-3 col-sm-6 text-center">
        <div class="card card-shadow">
            <div><a href="https://www.oxfordlearnersdictionaries.com/" target="_blank"><img class="card-img-top mx-auto" src="{% static 'img/oxford.jfif' %}" alt="Oxford Dictionary"></a></div>
            <div class="card-body home-card">
                <a href="{% url 'dictionary' word_ox.english %}" target="_blank">
                    <h4 id="word_2" class="font-weight-bold">{{ word_ox.english }}</h4>
                </a>
                {% if word_ox.turkish.all %}
                    <ul class="wotd-tr-list">
                    {% for tr in word_ox.turkish.all %}
                        <li>
                            {{ tr }}
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <ul class="wotd-tr-list no-tr" >
                        (...)
                    </ul>
                {% endif %}
                <div class="home-card-footer">
                {% if word_ox.audio is not None %}
                    <div>
                        <span class="audio">
                            <i title="Dinle" data-id="2" class="material-icons">volume_up</i>
                        </span>
                    </div>
                    <audio id="au-2" src="{{word_ox.audio}}"></audio>
                {% else %}
                    <div>
                        <span class="audio">
                            <i title="Ses mevcut değil" class="material-icons">volume_up</i>
                        </span>
                    </div>
                    <audio src=""></audio>
                {% endif %}
                {% if word_ox.turkish.all %}
                    {% if user.is_authenticated %}
                        {% if ox_exists %}
                            <div><button data-id="2" class="btn add-btn-home btn-after"><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="2" class="btn add-btn-home btn-before"><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before" data-toggle="modal" data-target="#loginModal"><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% else %}
                    {% if user.is_authenticated %}
                        {% if ox_exists %}
                            <div><button data-id="2" class="btn add-btn-home btn-after disabled not-allowed" disabled><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="2" class="btn add-btn-home btn-before disabled not-allowed" disabled><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before disabled not-allowed" data-toggle="modal" data-target="#loginModal" disabled><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% endif %}
                    </div>
            </div>
        </div>
    </div>

    <div class="col-lg-3 col-sm-6 text-center mb-sm-2">
        <div class="card card-shadow">
            <div><a href="https://www.dictionary.com/" target="_blank"><img class="card-img-top mx-auto dict" src="{% static 'img/dictionary.jpg' %}" alt="Dictionary"></a></div>
            <div class="card-body home-card">
                <a href="{% url 'dictionary' word_dict.english %}" target="_blank">
                    <h4 id="word_3" class="font-weight-bold">{{ word_dict.english }}</h4>
                </a>
                {% if word_dict.turkish.all %}
                    <ul class="wotd-tr-list">
                    {% for tr in word_dict.turkish.all %}
                        <li>
                            {{ tr }}
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <ul class="wotd-tr-list no-tr" >
                        (...)
                    </ul>
                {% endif %}
                <div class="home-card-footer">
                {% if word_dict.audio is not None %}
                <div>
                    <span class="audio">
                        <i title="Dinle" data-id="3" class="material-icons">volume_up</i>
                    </span>
                </div>
                <audio id="au-3" src="{{word_dict.audio}}"></audio>
                {% else %}
                <div>
                    <span class="audio">
                        <i title="Ses mevcut değil" class="material-icons">volume_off</i>
                    </span>
                </div>
                <audio src=""></audio>
                {% endif %}
                {% if word_dict.turkish.all %}
                    {% if user.is_authenticated %}
                        {% if dict_exists %}
                            <div><button data-id="3" class="btn add-btn-home btn-after"><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="3" class="btn add-btn-home btn-before"><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before" data-toggle="modal" data-target="#loginModal"><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% else %}
                    {% if user.is_authenticated %}
                        {% if dict_exists %}
                            <div><button data-id="3" class="btn add-btn-home btn-after disabled not-allowed" disabled><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="3" class="btn add-btn-home btn-before disabled not-allowed" disabled><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before disabled not-allowed" data-toggle="modal" data-target="#loginModal" disabled><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% endif %}
                    </div>
            </div>
        </div>
    </div>

    <div class="col-lg-3 col-sm-6 text-center mb-sm-2 mb-2">
        <div class="card card-shadow">
            <div><a href="https://dictionary.cambridge.org/" target="_blank"><img class="card-img-top mx-auto" src="{% static 'img/cambridge.png' %}" alt="Merriam Webster"></a></div>
            <div class="card-body home-card">
                <a href="{% url 'dictionary' word_camb.english %}" target="_blank">
                    <h4 id="word_4" class="font-weight-bold">{{ word_camb.english }}</h4>
                </a>
                {% if word_camb.turkish.all %}
                    <ul class="wotd-tr-list">
                    {% for tr in word_camb.turkish.all %}
                        <li>
                            {{ tr }}
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <ul class="wotd-tr-list no-tr" >
                        (...)
                    </ul>
                {% endif %}
                <div class="home-card-footer">
                {% if word_camb.audio is not None %}
                    <div>
                        <span class="audio">
                            <i title="Dinle" data-id="4" class="material-icons">volume_up</i>
                        </span>
                    </div>
                    <audio id="au-4" src="{{word_camb.audio}}"></audio>
                {% else %}
                    <div>
                        <span class="audio">
                            <i title="Ses mevcut değil" class="material-icons">volume_off</i>
                        </span>
                    </div>
                    <audio src=""></audio>
                {% endif %}
                {% if word_camb.turkish.all %}
                    {% if user.is_authenticated %}
                        {% if camb_exists %}
                            <div><button data-id="4" class="btn add-btn-home btn-after"><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="4" class="btn add-btn-home btn-before"><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before" data-toggle="modal" data-target="#loginModal"><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% else %}
                    {% if user.is_authenticated %}
                        {% if camb_exists %}
                            <div><button data-id="4" class="btn add-btn-home btn-after disabled not-allowed" disabled><span>Kelime Eklendi</span></button></div>
                        {% else %}
                            <div><button data-id="4" class="btn add-btn-home btn-before disabled not-allowed" disabled><span>Kelimeyi Ekle</span></button></div>
                        {% endif %}
                    {% else %}
                        <div><button class="btn add-btn-home btn-before disabled not-allowed" data-toggle="modal" data-target="#loginModal" disabled><span>Kelimeyi Ekle</span></button></div>
                    {% endif %}
                {% endif %}
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row">
    <div class="col-lg-3 col-sm-6">
        <div class="card card-note cn-1c">
            <div class="text-center"><span class="title-home title-last">Son Eklenenler</span></div>
            <div class="overflow-auto">
                <ul class="ul-last-added">
                    {% for word in last_words %}
                    <li>
                        <a href="{% url 'dictionary' word.english %}" target="_blank">{{ word.english }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="cn-2p col-lg-3 col-sm-6 mb-6">
        <div class="cn-2c card card-note">
            <span class="title-home title-star">Favoriler</span>
            <div class="overflow-auto position-relative">
                <ul class="ul-starred">
                    {% for word in rstrwords %}
                    <li>
                        <a href="{% url 'dictionary' word %}" target="_blank">{{ word }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% if user.is_authenticated %}
            <div class="ref-fav">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content ref ref-star">
                        <img class="ref-img ref-img-star" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            {% else %}
            <div class="ref-fav">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#loginModal">
                        <img class="ref-img ref-img-star" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            {% endif %}
        </div>
    </div>


    <div class="cn-3p col-lg-3 col-sm-6 mb-6">
        <div class="cn-3c card card-note">
            <span class="title-home title-unl">Öğreneceklerim</span>
            <div class="overflow-auto position-relative">
                <ul class="ul-unlearned">
                    {% for word in rulwords %}
                    <li>
                        <a href="{% url 'dictionary' word %}" target="_blank">{{ word }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% if user.is_authenticated %}
            <div class="ref-resp">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content ref ref-unl">
                        <img class="ref-img ref-img-unl" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            <div class="quiz-resp">
                <div class="swing quiz">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#quiz-unl">
                        Quiz
                    </button>
                </div>
            </div>
            {% else %}
            <div class="ref-resp">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#loginModal">
                        <img class="ref-img ref-img-unl" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            <div class="quiz-resp">
                <div class="swing quiz">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#loginModal">
                        Quiz
                    </button>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="cn-4p col-lg-3 col-sm-6 mb-7">
        <div class="cn-4c card card-note">
            <span class="title-home title-l">Öğrendiklerim</span>
            <div class="overflow-auto position-relative">
                <ul class="ul-learned">
                    {% for word in rlwords %}
                    <li>
                        <a href="{% url 'dictionary' word %}" target="_blank">{{ word }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% if user.is_authenticated %}
            <div class="ref-resp">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content ref ref-l">
                        <img class="ref-img ref-img-l" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            <div class="quiz-resp">
                <div class="swing quiz">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#quiz-l">
                        Quiz
                    </button>
                </div>
            </div>
            {% else %}
            <div class="ref-resp">
                <div class="swing refresh">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#loginModal">
                        <img class="ref-img ref-img-l" src="{% static 'img/ref-arrow-teal.png' %}" alt="yenile" height="24px" width="24px">
                    </button>
                </div>
            </div>
            <div class="quiz-resp">
                <div class="swing quiz">
                    <div class="object-rope"></div>
                    <button class="object-content" type="button" data-toggle="modal" data-target="#loginModal">
                        Quiz
                    </button>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

</div>

</div>

<div class="modal fade" id="quiz-unl" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content modal-content-unl py-4 px-sm-4 px-2">
        <span class="title-quiz">Günlük Quiz</span>
        <button type="button" class="close close-quiz" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <div class="modal-body modal-body-unl">
          <div class="modal-body-content modal-body-content-unl">
            <div>Günlük Quiz'e hoş geldin.</div>
            <div>Lütfen quiz'e başlamak için aşağıdan sorulmasını istediğin kelime sayısını seç.</div>
            <div >
              Not:
              <ul>
                <li>
                  Sorulacak olan kelimeler "öğreneceğim kelimeler" listesinden rasgele olarak seçilecektir.
                  Bu yüzden listende gerektiği kadar kelime olduğundan emin ol.
                  Listende şu an {{count_unl.0}} adet kelime var.
                </li>
                <li>
                  Bu quiz günde 1 defaya mahsustur ve her gün öğlen 12:00'de sıfırlanır.
                </li>
              </ul>
            </div>
            <div class="mt-4">
              <label for="quiz-unl">Kelime sayısı:</label>
              <select id="sel-unl" class="custom-select" name="Kelime sayısı">
                <option value="3">3</option>
                <option value="5">5</option>
                <option value="7">7</option>
              </select>
              <button class="btn btn-before start start-unl">Başlat</button>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="quiz-l" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content modal-content-l py-4 px-sm-4 px-2">
        <span class="title-quiz">Günlük Quiz</span>
        <button type="button" class="close close-quiz" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <div class="modal-body modal-body-l">
          <div class="modal-body-content modal-body-content-l">
            <div>Günlük Quiz'e hoş geldin.</div>
            <div>Lütfen quiz'e başlamak için aşağıdan sorulmasını istediğin kelime sayısını seç.</div>
            <div>
              Not:
              <ul>
                <li>
                  Sorulacak olan kelimeler "öğrendiğim kelimeler" listesinden rasgele olarak seçilecektir.
                  Bu yüzden listende gerektiği kadar kelime olduğundan emin ol.
                  Listende şu an {{count_l.0}} adet kelime var.
                </li>
                <li>
                  Vereceğin cevaplar kelimeyi listeye kaydettiğin Türkçe kelimelerden olmak zorundadır. Aksi halde
                  Türkçesi doğru olsa dahi kabul edilmez.
                </li>
                <li>
                  Her soruyu çözmek için 2 hakkın mevcut.
                </li>
                <li>
                  Bu quiz günde 1 defaya mahsustur ve her gün öğlen 12:00'de sıfırlanır.
                </li>
              </ul>
            </div>
            <div class="mt-4">
              <label for="sel-l">Kelime sayısı:</label>
              <select id="sel-l" class="custom-select" name="Kelime sayısı">
                <option value="3">3</option>
                <option value="5">5</option>
                <option value="7">7</option>
              </select>
              <button class="btn btn-before start start-l">Başlat</button>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

{% if not user.is_authenticated %}
<div class="modal fade" id="loginModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content modal-login">
        <div class="modal-header">
          <h6 class="modal-title">Bu özelliğe erişmek için lütfen giriş yapın..</h6>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <div class="modal-body">
            <form class="login d-grid" action="/accounts/login/?next{{request.path}}" method="POST">
                {% csrf_token %}
                <input class="login-input" type="email" name="login" placeholder="Email Adresi..." required>
                <input class="login-input" type="password" name="password" placeholder="Kullanıcı Şifresi..." required>
                <div>
                    <label class="custom-cb" for="remember">Beni Hatırla:
                        <input id="remember" type="checkbox">
                        <span class="checkbox"></span>
                    </label>
                </div>
                <button type="submit" class="btn-before my-2 login-btn">Giriş Yap</button>
                <a href="{% url 'account_signup' %}">Kayıt ol</a>
                <a href="/accounts/password/reset">Şifremi Unuttum</a>
                <div class="socialaccount_ballot login-btn">
                  <ul class="socialaccount_providers">
                    {% include "socialaccount/snippets/provider_list.html" with process="login" %}
                  </ul>
                </div>
            </form>
        </div>
      </div>
    </div>
</div>
{% endif %}



<script>
$(function(){

    $(".object-content").hover(
        function(){
            $(this).find("img").attr("src", "/static/img/ref-arrow-white.png")
        },
        function(){
            $(this).find("img").attr("src", "/static/img/ref-arrow-teal.png")
        },
    )

    $(".start").click(function() {
        if(!event.detail || event.detail == 1) {
            var ths = $(this)
            if (ths.hasClass("start-unl")) {
                if ( "{{is_quiz_unl_finished}}" == "Not Finished" ) {
                    $.ajax({
                        type:"POST",
                        url: "{% url 'complete_quiz' %}",
                        data: {
                            "quiz-unl": "quiz-unl",
                            "csrfmiddlewaretoken" : "{{csrf_token}}"
                        },
                        dataType: 'json',
                    })
                    var value = $("#sel-unl").val()
                    var correct_list = []
                    var incorrect_list = []
                    var count = "{{count_unl.0}}"
                    var gap = value - count
                    if ( gap > 0 ) {
                      if ( !($(".quiz-err-unl").length) ) {
                        ths.after(`<div class="quiz-err-unl mt-1">* Quiz\'e başlamak için listenizde yeterince kelime bulunmuyor.
                                    En az ${gap} kelime daha ekleyip tekrar deneyin.</div>`)
                      } else {
                        $(".quiz-err-unl").remove()
                        ths.after(`<div class="quiz-err-unl mt-1">* Quiz\'e başlamak için listenizde yeterince kelime bulunmuyor.
                                    En az ${gap} kelime daha ekleyip tekrar deneyin.</div>`)
                      }
                    } else {
                      $(".quiz-err-unl").remove()
                      $(".modal-body-content-unl").fadeOut()
                      setTimeout(function() {
                        $(".modal-body-content-unl").empty()
                        $(".modal-body-unl").append(`<div class="loader-wrapper loader-wrapper-unl">
                                                      <div class="loader loader">
                                                        <div>
                                                          <ul>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg></li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            </ul>
                                                        </div>
                                                        <span>Yükleniyor</span>
                                                      </div>
                                                     </div>`)
                      }, 500);
                      setTimeout(function() {
                        $(".loader-wrapper-unl").remove()
                        $(".modal-body-content-unl").append(
                          `<div role="tabpanel">
                            <ul class="nav nav-tabs-unl" role="tablist"></ul>
                            <div class="tab-content tab-content-unl"></div>
                           </div>
                            <div class="modal fade confirm" id="confirm" tabindex="-1" role="dialog" aria-labelledby="confirm" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" id="confirm" role="document">
                                    <div class="modal-content quiz-finish-modal">
                                      <div id="confirm-text" class="modal-body"></div>
                                      <div class="modal-footer">
                                        <button id="confirm-no" type="button" class="btn btn-danger-custom" data-dismiss="confirm">İptal</button>
                                        <button id="confirm-ok" type="button" class="btn btn-before">Onayla</button>
                                      </div>
                                    </div>
                                </div>
                            </div>`)
                        for (i=1;i<=value;i++) {
                          $(".nav-tabs-unl").append(`<li role="presentation" class="nav-item">
                                                    <a class="nav-link" href="#unl-${i}" aria-controls="unl-${i}" role="tab" data-toggle="tab">${i}</a>
                                                    </li>`)
                          $(".tab-content-unl").append(`<div data-no="${i}" role="tabpanel" class="tab-pane" id="unl-${i}"></div>`)
                        }
                        $(".nav-tabs-unl").find("a").first().click()
                        $.ajax({
                            type:"GET",
                            url: "{% url 'random-refresh' %}",
                            data: {
                                'random-unlearned': value,
                            },
                            dataType: 'json',
                            success: function(data) {
                                var tr_list = data.tr_list
                                if (data.random_unlearned) {
                                    data.random_unlearned.map(function(i) {
                                        var index = data.random_unlearned.indexOf(i) + 1
                                        var tr = tr_list[index-1]
                                        $(`#unl-${index}`).append(`<div class="quiz-question mb-2">
                                        <button class="chevron-left"><i class="fas fa-chevron-left chevron"></i></button>
                                        <span class="word-unl">${i}</span>
                                        <button class="chevron-right"><i class="fas fa-chevron-right chevron"></i></button>
                                        </div>
                                        <div class="d-flex justify-content-center hak")>0/2</div>
                                        <div class="d-flex justify-content-center mb-2 mt-1">
                                            <input type="text" class="quiz-answer mr-1" placeholder="Min. 2 harf" onClick="this.setSelectionRange(0, this.value.length)">
                                            <div class="quiz-result"></div>
                                        </div>
                                        <div class="d-flex justify-content-center">
                                            <button class="btn btn-info btn-sm mr-2 quiz-dk-unl">Bilmiyorum</button>
                                            <button class="btn btn-success btn-sm quiz-answer-btn">Cevapla</button>
                                        </div>
                                        <div class="mt-3 quiz-tr">
                                            <div>Türkçeleri:</div>
                                            <div><ul></ul></div>
                                        </div>
                                        <button class="btn btn-danger-custom quiz-finish" data-toggle="confirmation">Quiz'i bitir</button>`)
                                    })
                                    $(document).on("click", ".quiz-dk-unl", function() {
                                        let ths = $(this)
                                        var no = parseInt(ths.parent().parent().attr("data-no"))
                                        var tr = tr_list[no-1]
                                        ths.parent().prev().find(".quiz-answer").addClass("box-dk").prop("placeholder", "")
                                        .prop("disabled", "true").css("opacity", ".65")
                                        ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                        ths.next().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                        var word = ths.parent().prevAll().eq(2).find("span").text()
                                        incorrect_list.push(word)
                                        tr.map(function(i){
                                            ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                        })
                                        $(this).parent().prev().find(".quiz-result").append(`
                                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                            <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                             stroke-linecap="round" stroke-miterlimit="10" x1="34.4" y1="37.9" x2="87.8" y2="92.3"/>
                                            <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                             stroke-linecap="round" stroke-miterlimit="10" x1="89.8" y1="38" x2="34.4" y2="92.2"/>
                                            </svg>`)
                                        setTimeout(function() {
                                            ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                        }, 1000);
                                    })
                                    $(document).on("keypress", ".quiz-answer", function() {
                                        var keycode = (event.keyCode ? event.keyCode : event.which)
                                        if(keycode == '13'){
                                            $(this).parent().next().find(".quiz-answer-btn").click()
                                        }
                                    })
                                    $(document).on("click", ".quiz-answer-btn", function() {
                                        var count = parseInt($(this).parent().prev().prev().text().split("/")[0])
                                        var no = parseInt($("a.active").text())
                                        let ths = $(this)
                                        var tr = tr_list[no-1]
                                        if (ths.parent().prev().find(".quiz-answer").val().length >= 2) {
                                            if (tr.includes( ths.parent().prev().find(".quiz-answer").val().toLowerCase() )) {
                                                if ( ths.parent().prev().find(".quiz-answer").hasClass("shake") ) {
                                                    ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                }
                                                ths.parent().prev().find(".quiz-answer").css("border-color", "#2cb74c")
                                                .css("box-shadow", "0px 0px 5px #2cb74c").prop("disabled", "true").css("opacity", ".65")
                                                ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                ths.prev().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                var word = ths.parent().prevAll().eq(2).find("span").text()
                                                correct_list.push(word)
                                                tr.map(function(i){
                                                    ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                                })
                                                ths.parent().prev().find(".quiz-result").append(`
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                                <polyline class="path check" fill="none" stroke="#2cb74c" stroke-width="6"
                                                stroke-linecap="round" stroke-miterlimit="10" points="100.2,40.2 51.5,88.8 29.8,67.5 "/>
                                                </svg>`)
                                                setTimeout(function() {
                                                    ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                                }, 1000);
                                            } else {
                                                if (count==0) {
                                                    ths.parent().prev().find(".quiz-answer").addClass("shake box-dk")
                                                    ths.parent().prev().prev().html("1/2")
                                                    setTimeout(function() {
                                                        ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                    }, 300);
                                                } else if (count==1) {
                                                    if ( ths.parent().prev().find(".quiz-answer").hasClass("shake") ) {
                                                        ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                    }
                                                    ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                    ths.prev().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                    ths.parent().prev().prev().html("2/2")
                                                    ths.parent().prev().find(".quiz-answer").prop("disabled", "true").css("opacity", ".65")
                                                    var word = $(this).parent().prevAll().eq(2).find("span").text()
                                                    incorrect_list.push(word)
                                                    tr.map(function(i){
                                                        ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                                    })
                                                    ths.parent().prev().find(".quiz-result").append(`
                                                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                                        <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                                         stroke-linecap="round" stroke-miterlimit="10" x1="34.4" y1="37.9" x2="87.8" y2="92.3"/>
                                                        <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                                         stroke-linecap="round" stroke-miterlimit="10" x1="89.8" y1="38" x2="34.4" y2="92.2"/>
                                                        </svg>`)
                                                    setTimeout(function() {
                                                        ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                                    }, 1000);
                                                }
                                            }
                                        } else {
                                            ths.parent().prev().find(".quiz-answer").addClass("shake")
                                            setTimeout(function() {
                                                ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                            }, 300);
                                        }
                                    })
                                    $(document).on("click", ".quiz-finish", function() {
                                        if ((incorrect_list.length + correct_list.length) < value) {
                                            $("#confirm-text").html("Cevaplamadığın sorular var.<br> Quiz'i bitirmek istediğine emin misin?")
                                            $("#confirm").modal()
                                        } else {
                                            $("#confirm-text").html("Quiz'i bitirmek istediğine emin misin?")
                                            $("#confirm").modal()
                                        }
                                    })
                                    $(document).on("click", "#confirm-ok", function(e) {
                                        e.preventDefault()
                                        $(document).find(".quiz-dk-unl").click()
                                        $(".nav-tabs-unl").append(`<li role="presentation" class="nav-item">
                                                                    <a class="nav-link" href="#res-unl" aria-controls="res-unl" role="tab" data-toggle="tab"><i class="fas fa-list-ol"></i></a>
                                                                   </li>`)
                                        $(".tab-content-unl").append(`<div role="tabpanel" class="tab-pane" id="res-unl">
                                                                        <div>
                                                                            <h3>Sonuçlar</h3>
                                                                            ${value} adet sorudan ${correct_list.length} tanesini doğru yaptın.
                                                                            <ul id="res-unl-ul"></ul>
                                                                        </div>
                                                                      </div>`)
                                        for (i=0;i<value;i++) {
                                            word = $(document).find(".word-unl").eq(i).text()
                                            if (correct_list.includes(word)) {
                                                $("#res-unl-ul").append(`<li data-id="${i}">
                                                                      <a href="" data-id="res-word" style="color:#2cb74c">${word}</a>
                                                                      <div class="dropdown">
                                                                          <butt on class="btn-dd"
                                                                                  type="button" id="dropdownResUnl" data-toggle="dropdown"
                                                                                  aria-haspopup="true" aria-expanded="false">
                                                                            <img src="{% static 'img/menu.png' %}" alt="Menu">
                                                                          </button>
                                                                          <div class="dropdown-menu" aria-labelledby="dropdownResUnl">
                                                                            <a class="dropdown-item" href="#!">Listende görüntüle</a>
                                                                            <a class="dropdown-item" href="#!">Sözlükte arat</a>
                                                                            <a class="dropdown-item" href="#!">Kelimeyi unuttum</a>
                                                                            <a class="dropdown-item" href="#!">Hatırlatıcıya ekle</a>
                                                                            <a class="dropdown-item" href="#!">Favorilere ekle</a>
                                                                          </div>
                                                                      </div>
                                                                      </li>`)
                                            } else {
                                                $("#res-unl-ul").append(`<li data-id="${i}">
                                                                      <a href="" data-id="res-word" style="color:#ff4e4e">${word}</a>
                                                                      <div class="dropdown">
                                                                          <button class="btn-dd"
                                                                                  type="button" id="dropdownResUnl" data-toggle="dropdown"
                                                                                  aria-haspopup="true" aria-expanded="false">
                                                                            <img src="{% static 'img/menu.png' %}" alt="Menu">
                                                                          </button>
                                                                          <div class="dropdown-menu" aria-labelledby="dropdownResUnl">
                                                                            <a class="dropdown-item" href="#!">Listende görüntüle</a>
                                                                            <a class="dropdown-item" href="#!">Sözlükte arat</a>
                                                                            <a class="dropdown-item" href="#!">Kelimeyi unuttum</a>
                                                                            <a class="dropdown-item" href="#!">Hatırlatıcıya ekle</a>
                                                                            <a class="dropdown-item" href="#!">Favorilere ekle</a>
                                                                          </div>
                                                                      </div>
                                                                      </li>`)
                                            }
                                        }
                                        $(".quiz-finish").remove()
                                        $("a[data-id='res-word']").click(function(e){
                                            e.preventDefault()
                                            var target = $(this).parent().attr("data-id")
                                            $("a.nav-link").eq(target).click()
                                        })
                                        $("#confirm").modal("hide")
                                        setTimeout(function() {
                                            $("a[aria-controls='res-unl']").click()
                                        }, 4);
                                    })
                                    $(document).on("click", "#confirm-no", function(e) {
                                        e.preventDefault()
                                        $("#confirm").modal("hide")
                                    })
                                    $(".quiz-question:first").find(".chevron-left").remove()
                                    $(".quiz-question:last").find(".chevron-right").remove()
                                }
                            }
                        })
                        $(".modal-body-content-unl").fadeIn()
                      }, 3300)
                    }
                } else if ( "{{is_quiz_unl_finished}}" == "Finished" ) {
                    $(".quiz-err-unl").remove()
                    ths.after(`<div class="quiz-err-unl mt-1">* Günlük Quiz'inizi zaten tamamlamışsınız.
                                                                Yarın tekrar gelin!</div>`)
                }

            } else if (ths.hasClass("start-l")) {
                if ( "{{is_quiz_l_finished}}" == "Not Finished" ) {
                    $.ajax({
                        type:"POST",
                        url: "{% url 'complete_quiz' %}",
                        data: {
                            "quiz-l": "quiz-l",
                            "csrfmiddlewaretoken" : "{{csrf_token}}"
                        },
                        dataType: 'json',
                    })
                    var value = $("#sel-l").val()
                    var correct_list = []
                    var incorrect_list = []
                    var count = "{{count_l.0}}"
                    var gap = value - count
                    if ( gap > 0 ) {
                      if ( !($(".quiz-err-l").length) ) {
                        ths.after(`<div class="quiz-err-l mt-1">* Quiz\'e başlamak için listenizde yeterince kelime bulunmuyor.
                                    En az ${gap} kelime daha ekleyip tekrar deneyin.</div>`)
                      } else {
                        $(".quiz-err-l").remove()
                        ths.after(`<div class="quiz-err-l mt-1">* Quiz\'e başlamak için listenizde yeterince kelime bulunmuyor.
                                    En az ${gap} kelime daha ekleyip tekrar deneyin.</div>`)
                      }
                    } else {
                      $(".quiz-err-l").remove()
                      $(".modal-body-content-l").fadeOut()
                      setTimeout(function() {
                        $(".modal-body-content-l").empty()
                        $(".modal-body-l").append(`<div class="loader-wrapper loader-wrapper-l">
                                                      <div class="loader loader">
                                                        <div>
                                                          <ul>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg></li>
                                                            <li><svg viewBox="0 0 90 120" fill="currentColor">
                                                                  <path d="M90,0 L90,120 L11,120 C4.92486775,120 0,115.075132 0,109 L0,11 C0,4.92486775 4.92486775,0 11,0 L90,0 Z M71.5,81 L18.5,81 C17.1192881,81 16,82.1192881 16,83.5 C16,84.8254834 17.0315359,85.9100387 18.3356243,85.9946823 L18.5,86 L71.5,86 C72.8807119,86 74,84.8807119 74,83.5 C74,82.1745166 72.9684641,81.0899613 71.6643757,81.0053177 L71.5,81 Z M71.5,57 L18.5,57 C17.1192881,57 16,58.1192881 16,59.5 C16,60.8254834 17.0315359,61.9100387 18.3356243,61.9946823 L18.5,62 L71.5,62 C72.8807119,62 74,60.8807119 74,59.5 C74,58.1192881 72.8807119,57 71.5,57 Z M71.5,33 L18.5,33 C17.1192881,33 16,34.1192881 16,35.5 C16,36.8254834 17.0315359,37.9100387 18.3356243,37.9946823 L18.5,38 L71.5,38 C72.8807119,38 74,36.8807119 74,35.5 C74,34.1192881 72.8807119,33 71.5,33 Z"></path>
                                                                </svg>
                                                            </li>
                                                            </ul>
                                                        </div>
                                                        <span>Yükleniyor</span>
                                                      </div>
                                                     </div>`)
                      }, 500);
                      setTimeout(function() {
                        $(".loader-wrapper-l").remove()
                        $(".modal-body-content-l").append(
                          `<div role="tabpanel">
                            <ul class="nav nav-tabs-l" role="tablist"></ul>
                            <div class="tab-content tab-content-l"></div>
                           </div>
                            <div class="modal fade confirm" id="confirm" tabindex="-1" role="dialog" aria-labelledby="confirm" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" id="confirm" role="document">
                                    <div class="modal-content quiz-finish-modal">
                                      <div id="confirm-text" class="modal-body"></div>
                                      <div class="modal-footer">
                                        <button id="confirm-no" type="button" class="btn btn-secondary" data-dismiss="confirm">İptal</button>
                                        <button id="confirm-ok" type="button" class="btn btn-before">Onayla</button>
                                      </div>
                                    </div>
                                </div>
                            </div>`)
                        for (i=1;i<=value;i++) {
                          $(".nav-tabs-l").append(`<li role="presentation" class="nav-item">
                                                    <a class="nav-link" href="#l-${i}" aria-controls="l-${i}" role="tab" data-toggle="tab">${i}</a>
                                                    </li>`)
                          $(".tab-content-l").append(`<div data-no="${i}" role="tabpanel" class="tab-pane" id="l-${i}"></div>`)
                        }
                        $(".nav-tabs-l").find("a").first().click()
                        $.ajax({
                            type:"GET",
                            url: "{% url 'random-refresh' %}",
                            data: {
                                'random-learned': value,
                            },
                            dataType: 'json',
                            success: function(data) {
                                var tr_list = data.tr_list
                                if (data.random_learned) {
                                    data.random_learned.map(function(i) {
                                        var index = data.random_learned.indexOf(i) + 1
                                        var tr = tr_list[index-1]
                                        $(`#l-${index}`).append(`<div class="quiz-question mb-2">
                                        <button class="chevron-left"><i class="fas fa-chevron-left chevron"></i></button>
                                        <span class="word-l">${i}</span>
                                        <button class="chevron-right"><i class="fas fa-chevron-right chevron"></i></button>
                                        </div>
                                        <div class="d-flex justify-content-center hak")>0/2</div>
                                        <div class="d-flex justify-content-center mb-2 mt-1">
                                            <input type="text" class="quiz-answer mr-1" placeholder="Min. 2 harf" onClick="this.setSelectionRange(0, this.value.length)">
                                            <div class="quiz-result"></div>
                                        </div>
                                        <div class="d-flex justify-content-center">
                                            <button class="btn btn-info btn-sm mr-2 quiz-dk-l">Bilmiyorum</button>
                                            <button class="btn btn-success btn-sm quiz-answer-btn">Cevapla</button>
                                        </div>
                                        <div class="mt-3 quiz-tr">
                                            <div>Türkçeleri:</div>
                                            <div><ul></ul></div>
                                        </div>
                                        <button class="btn btn-danger-custom quiz-finish" data-toggle="confirmation">Quiz'i bitir</button>`)
                                    })
                                    $(document).on("click", ".quiz-dk-l", function() {
                                        let ths = $(this)
                                        var no = parseInt(ths.parent().parent().attr("data-no"))
                                        var tr = tr_list[no-1]
                                        ths.parent().prev().find(".quiz-answer").addClass("box-dk").prop("placeholder", "")
                                        .prop("disabled", "true").css("opacity", ".65")
                                        ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                        ths.next().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                        var word = ths.parent().prevAll().eq(2).find("span").text()
                                        incorrect_list.push(word)
                                        tr.map(function(i){
                                            ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                        })
                                        $(this).parent().prev().find(".quiz-result").append(`
                                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                            <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                             stroke-linecap="round" stroke-miterlimit="10" x1="34.4" y1="37.9" x2="87.8" y2="92.3"/>
                                            <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                             stroke-linecap="round" stroke-miterlimit="10" x1="89.8" y1="38" x2="34.4" y2="92.2"/>
                                            </svg>`)
                                        setTimeout(function() {
                                            ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                        }, 1000);
                                    })
                                    $(document).on("keypress", ".quiz-answer", function() {
                                        var keycode = (event.keyCode ? event.keyCode : event.which)
                                        if(keycode == '13'){
                                            $(this).parent().next().find(".quiz-answer-btn").click()
                                        }
                                    })
                                    $(document).on("click", ".quiz-answer-btn", function() {
                                        var count = parseInt($(this).parent().prev().prev().text().split("/")[0])
                                        var no = parseInt($("a.active").text())
                                        let ths = $(this)
                                        var tr = tr_list[no-1]
                                        if (ths.parent().prev().find(".quiz-answer").val().length >= 2) {
                                            if (tr.includes( ths.parent().prev().find(".quiz-answer").val().toLowerCase() )) {
                                                if ( ths.parent().prev().find(".quiz-answer").hasClass("shake") ) {
                                                    ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                }
                                                ths.parent().prev().find(".quiz-answer").css("border-color", "#2cb74c")
                                                .css("box-shadow", "0px 0px 5px #2cb74c").prop("disabled", "true").css("opacity", ".65")
                                                ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                ths.prev().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                var word = ths.parent().prevAll().eq(2).find("span").text()
                                                correct_list.push(word)
                                                tr.map(function(i){
                                                    ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                                })
                                                ths.parent().prev().find(".quiz-result").append(`
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                                <polyline class="path check" fill="none" stroke="#2cb74c" stroke-width="6"
                                                stroke-linecap="round" stroke-miterlimit="10" points="100.2,40.2 51.5,88.8 29.8,67.5 "/>
                                                </svg>`)
                                                setTimeout(function() {
                                                    ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                                }, 1000);
                                            } else {
                                                if (count==0) {
                                                    ths.parent().prev().find(".quiz-answer").addClass("shake box-dk")
                                                    ths.parent().prev().prev().html("1/2")
                                                    setTimeout(function() {
                                                        ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                    }, 300);
                                                } else if (count==1) {
                                                    if ( ths.parent().prev().find(".quiz-answer").hasClass("shake") ) {
                                                        ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                                    }
                                                    ths.prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                    ths.prev().prop("disabled", "true").addClass("disabled").addClass("not-allowed")
                                                    ths.parent().prev().prev().html("2/2")
                                                    ths.parent().prev().find(".quiz-answer").prop("disabled", "true").css("opacity", ".65")
                                                    var word = $(this).parent().prevAll().eq(2).find("span").text()
                                                    incorrect_list.push(word)
                                                    tr.map(function(i){
                                                        ths.parent().next().find("ul").hide().append(`<li>${i}</li>`).fadeIn()
                                                    })
                                                    ths.parent().prev().find(".quiz-result").append(`
                                                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                                        <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                                         stroke-linecap="round" stroke-miterlimit="10" x1="34.4" y1="37.9" x2="87.8" y2="92.3"/>
                                                        <line class="path line" fill="none" stroke="#ff4e4e" stroke-width="6"
                                                         stroke-linecap="round" stroke-miterlimit="10" x1="89.8" y1="38" x2="34.4" y2="92.2"/>
                                                        </svg>`)
                                                    setTimeout(function() {
                                                        ths.parent().prev().find(".quiz-result").find(".path").removeClass("path")
                                                    }, 1000);
                                                }
                                            }
                                        } else {
                                            ths.parent().prev().find(".quiz-answer").addClass("shake")
                                            setTimeout(function() {
                                                ths.parent().prev().find(".quiz-answer").removeClass("shake")
                                            }, 300);
                                        }
                                    })
                                    $(document).on("click", ".quiz-finish", function() {
                                        if ((incorrect_list.length + correct_list.length) < value) {
                                            $("#confirm-text").html("Cevaplamadığın sorular var.<br> Quiz'i bitirmek istediğine emin misin?")
                                            $("#confirm").modal()
                                        } else {
                                            $("#confirm-text").html("Quiz'i bitirmek istediğine emin misin?")
                                            $("#confirm").modal()
                                        }
                                    })
                                    $(document).on("click", "#confirm-ok", function(e) {
                                        e.preventDefault()
                                        $(document).find(".quiz-dk-l").click()
                                        $(".nav-tabs-l").append(`<li role="presentation" class="nav-item">
                                                                    <a class="nav-link" href="#res-l" aria-controls="res-l" role="tab" data-toggle="tab">
                                                                        <i class="fas fa-list-ol"></i>
                                                                    </a>
                                                                 </li>`)
                                        $(".tab-content-l").append(`<div role="tabpanel" class="tab-pane" id="res-l">
                                                                        <div>
                                                                            <h3>Sonuçlar</h3>
                                                                            ${value} adet sorudan ${correct_list.length} tanesini doğru yaptın.
                                                                            <ul id="res-l-ul"></ul>
                                                                        </div>
                                                                      </div>`)
                                        for (i=0;i<value;i++) {
                                            word = $(document).find(".word-l").eq(i).text()
                                            if (correct_list.includes(word)) {
                                                $("#res-l-ul").append(`<li data-id="${i}">
                                                                      <a href="" data-id="res-word" style="color:#2cb74c">${word}</a>
                                                                      <div class="dropdown">
                                                                          <button class="btn-dd"
                                                                                  type="button" id="dropdownResL" data-toggle="dropdown"
                                                                                  aria-haspopup="true" aria-expanded="false">
                                                                            <img src="{% static 'img/menu.png' %}" alt="Menu">
                                                                          </button>
                                                                          <div class="dropdown-menu" aria-labelledby="dropdownResL">
                                                                            <a class="dropdown-item" href="#!">Listende görüntüle</a>
                                                                            <a class="dropdown-item" href="#!">Sözlükte arat</a>
                                                                            <a class="dropdown-item" href="#!">Kelimeyi unuttum</a>
                                                                            <a class="dropdown-item" href="#!">Hatırlatıcıya ekle</a>
                                                                            <a class="dropdown-item" href="#!">Favorilere ekle</a>
                                                                          </div>
                                                                      </div>
                                                                      </li>`)
                                            } else {
                                                $("#res-l-ul").append(`<li data-id="${i}">
                                                                      <a href="" data-id="res-word" style="color:#ff4e4e">${word}</a>
                                                                      <div class="dropdown">
                                                                          <button class="btn-dd"
                                                                                  type="button" id="dropdownResL" data-toggle="dropdown"
                                                                                  aria-haspopup="true" aria-expanded="false">
                                                                            <img src="{% static 'img/menu.png' %}" alt="Menu">
                                                                          </button>
                                                                          <div class="dropdown-menu" aria-labelledby="dropdownResL">
                                                                            <a class="dropdown-item" href="#!">Listende görüntüle</a>
                                                                            <a class="dropdown-item" href="#!">Sözlükte arat</a>
                                                                            <a class="dropdown-item" href="#!">Kelimeyi unuttum</a>
                                                                            <a class="dropdown-item" href="#!">Hatırlatıcıya ekle</a>
                                                                            <a class="dropdown-item" href="#!">Favorilere ekle</a>
                                                                          </div>
                                                                      </div>
                                                                      </li>`)
                                            }
                                        }
                                        $(".quiz-finish").remove()
                                        $("a[data-id='res-word']").click(function(e){
                                            e.preventDefault()
                                            var target = $(this).parent().attr("data-id")
                                            $("a.nav-link").eq(target).click()
                                        })
                                        $("#confirm").modal("hide")
                                        setTimeout(function() {
                                            $("a[aria-controls='res-l']").click()
                                        }, 4);
                                    })
                                    $(document).on("click", "#confirm-no", function(e) {
                                        e.preventDefault()
                                        $("#confirm").modal("hide")
                                    })
                                    $(".quiz-question:first").find(".chevron-left").remove()
                                    $(".quiz-question:last").find(".chevron-right").remove()
                                }
                            }
                        })
                        $(".modal-body-content-l").fadeIn()
                      }, 3300)
                    }
                } else if ( "{{is_quiz_l_finished}}" == "Finished" ) {
                    $(".quiz-err-l").remove()
                    ths.after(`<div class="quiz-err-l mt-1">* Günlük Quiz'inizi zaten tamamlamışsınız.
                                                                Yarın tekrar gelin!</div>`)
                }
            }
        }
    })

    $(document).on("click", '.chevron-left', function() {
        var target = parseInt($(this).parent().parent().attr("id").split("-")[1]) - 2
        $("a.nav-link").eq(target).click()
    })

    $(document).on("click", '.chevron-right', function() {
        var target = parseInt($(this).parent().parent().attr("id").split("-")[1])
        $("a.nav-link").eq(target).click()
    })

    $(document).keydown(function(e){
        if (e.keyCode == 37) {
            $("div.active").find(".chevron-left").click()
            setTimeout(function() {
                $("div.active").find(".quiz-answer").focus()
            }, 4);
        } else if (e.keyCode == 39) {
            $("div.active").find(".chevron-right").click()
            setTimeout(function() {
                $("div.active").find(".quiz-answer").focus()
            }, 4);
        }
    });

    function mediaContainer(container) {
      if (container.matches) {
        $(".container-media").addClass("container")
      } else {
        $(".container-media").removeClass("container")
      }
    }
    var container = window.matchMedia("(min-width:576px)")
    mediaContainer(container)
    container.addListener(mediaContainer)

    $(".ref").click(function() {
        var ths = $(this);
        if (ths.hasClass('ref-l')) {
            if (ths.parents().eq(3).hasClass("flip-card")) {
                ths.parents().eq(3).removeClass("flip-card")
            } else {
                ths.parents().eq(3).addClass("flip-card")
            }
            $.ajax({
                type:"GET",
                url: "{% url 'random-refresh' %}",
                async: false,
                data: {
                    'random-learned': "refresh",
                },
                dataType: 'json',
                success: function(data) {
                    if (data.random_learned) {
                        var ref;
                        var quiz;
                        setTimeout(function() {
                            $(".ul-learned").empty();
                            $(".title-l").css("z-index", "-1").html("")
                            ref = $(".ref-img-l").detach()
                            $("button[data-target='#quiz-l']").html("")
                        },700)
                        setTimeout(function() {
                            $(".title-l").css("z-index", "initial").html("Öğrendiklerim")
                            $(".ref-l").prepend(ref)
                            $("button[data-target='#quiz-l']").html("Quiz")
                            data.random_learned.map(function(i) {
                                $(".ul-learned").append(`<li><a class="teal" href="/sözlük/q=${i}/">${i}</a></li>`);
                            });
                        },1900)
                    }
                }
            }) // ajax
        } else if (ths.hasClass('ref-unl')) {
            if (ths.parents().eq(3).hasClass("flip-card")) {
                ths.parents().eq(3).removeClass("flip-card")
            } else {
                ths.parents().eq(3).addClass("flip-card")
            }
            $.ajax({
                type:"GET",
                url: "{% url 'random-refresh' %}",
                async: false,
                data: {
                    'random-unlearned': "refresh",
                },
                dataType: 'json',
                success: function(data) {
                    if (data.random_unlearned) {
                        var ref;
                        var quiz;
                        setTimeout(function() {
                            $(".ul-unlearned").empty();
                            $(".title-unl").css("z-index", "-1").html("")
                            ref = $(".ref-img-unl").detach()
                            $("button[data-target='#quiz-unl']").html("")
                        },700)
                        setTimeout(function() {
                            $(".title-unl").css("z-index", "initial").html("Öğreneceklerim")
                            $(".ref-unl").prepend(ref)
                            $("button[data-target='#quiz-unl']").html("Quiz")
                            data.random_unlearned.map(function(i) {
                                $(".ul-unlearned").append(`<li><a class="teal" href="/sözlük/q=${i}/">${i}</a></li>`);
                            });
                        },1900)
                    }
                }
            })
        }
        else if (ths.hasClass('ref-star')) {
            if (ths.parents().eq(3).hasClass("flip-card")) {
                ths.parents().eq(3).removeClass("flip-card")
            } else {
                ths.parents().eq(3).addClass("flip-card")
            }
            $.ajax({
                type:"GET",
                url: "{% url 'random-refresh' %}",
                async: false,
                data: {
                    'random-starred': 'refresh',
                },
                dataType: 'json',
                success: function(data) {
                    if (data.random_starred) {
                        var ref;
                        var quiz;
                        setTimeout(function() {
                            $(".ul-starred").empty();
                            $(".title-star").css("z-index", "-1").html("")
                            ref = $(".ref-img-star").detach()
                        },700)
                        setTimeout(function() {
                            $(".title-star").css("z-index", "initial").html("Favoriler")
                            $(".ref-star").prepend(ref)
                            data.random_starred.map(function(i) {
                                $(".ul-starred").append(`<li><a class="teal" href="/sözlük/q=${i}/">${i}</a></li>`);
                            });
                        },1900)
                    }
                }
            })
        }
    })

    $(".audio").click(function() {
        $(this).parent().next()[0].play()
    });

    $(".add-btn-home").on("click", function(){
        var ths = $(this)
        var no = ths.attr('data-id')
        var en = $("#word_" + no).text()
        var tr_list = []
        ths.parent().parent().prev().children().map(function(){
            tr_list.push($(this).text().toLowerCase().trim())
        })
        var audio = $("#au-" + no).attr("src")

        if ( !(isNaN(no)) ) {
            if (ths.find("span").html() == "Kelimeyi Ekle") {
                $.ajax({
                    type:"GET",
                    url: "/word_cd",
                    data:{
                       "word_en": en,
                       "tr": tr_list,
                       "audio": audio
                    },
                    success: function(data) {
                        ths.toggleClass("btn-before btn-after");
                        ths.find("span").html("Kelime Eklendi");
                    }
                });

            } else if (ths.find("span").html() == "Kelime Eklendi") {
                $.ajax({
                     type:"GET",
                     url: "/word_cd",
                     data:{
                        "word_en": en,
                        "tr": tr_list,
                        "audio": audio
                     },
                     success: function(data) {
                        ths.toggleClass("btn-after btn-before");
                        ths.find("span").html("Kelimeyi Ekle");
                     }
                }); // end ajax
            } // end else if
        }
    });


}); // end ready
</script>

{% endblock %}